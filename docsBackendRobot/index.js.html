<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Index.js Receives requests from the frontend of the web platform.
 */
const express = require('express')
const app = express()
const port = 10000
const rosnodejs = require('rosnodejs')
const cors = require ("cors")
app.use(cors({ credentials:true, origin:'http://192.168.1.128:3000' }))

/**
 * Module to send robot to a position
 * @module sendLocation
 */
app.get('/sendLocation', function (req, res) {
    var value = req.query["value"]
    //res.json({"value" : value})
    console.log(value)
    rosnodejs.initNode('my_node', {onTheFly: true})
    .then(nh => {
      const std_msgs = rosnodejs.require('std_msgs');
      const pub = nh.advertise('/recognizer/output', 'std_msgs/String');
      const msg = new std_msgs.msg.String();
      msg.data = value;
      pub.publish(msg);
    })
    .catch(err => {
      console.log(err);
    });
});

/**
 * Module to get robot position
 * @module getPosition
 */
app.get('/getPosition', function (req, res) {
  /* const nh = rosnodejs.nh;
  var position;
    rosnodejs.initNode('/listener', {onTheFly: true})
    .then(nh => {
      const std_msgs = rosnodejs.require('geometry_msgs');
      nh.subscribe('/robot_pose', 'geometry_msgs/Pose', (data) => {console.log('Got msg on chatter: %j', data);
      position = data
    });
    }) */
    const cp = require('child_process');
  cp.exec('rostopic echo -n 1 /robot_pose/position', (err, stdout, stderr) => {
  if (err) {
    //some err occurred
    console.error(err)
  } else {
   // the *entire* stdout and stderr (buffered)
   console.log(`stdout: ${stdout}`);
  }
  res.json({"salida":stdout})
  });
    
});

app.listen(port, () => {
  console.log(`Example app listening on port ${port}`)
})</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-getPosition.html">getPosition</a></li><li><a href="module-sendLocation.html">sendLocation</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Wed Jul 13 2022 13:32:40 GMT+0200 (hora de verano de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
